{% extends "home/base.html" %}
{% load static %}
{% load i18n %}
{% load filters %}

{% block content %}

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
          integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p"
          crossorigin="anonymous"/>

    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    {% comment %} ADD ROOM {% endcomment %}
    <div class="col-md-2 offset-8">
        <a class="btn btn-info btn-sm" href="{% url 'chat:add_room' %}">+{% trans 'Add Room' %}</a>
    </div>

    {% comment %} PUBLIC CHAT ROOMS {% endcomment %}
    <ul class="rooms col-md-8">
        <h4>{% trans 'Public chat rooms' %}</h4>
        {% for room in allowed_rooms %}
            {% if room.public == True and room.archived == False %}
                <li class="room-link text-uppercase {{ room|seen_by:user }}"
                    data-room-type="public"
                    data-room-id="{{ room.id }}">{{ room|name_for:user }}</li>
            {% endif %}
        {% endfor %}
    </ul>

    {% comment %} PRIVATE MESSAGES {% endcomment %}
    <ul class="rooms col-md-8">
        <h4>{% trans 'Private messages' %}</h4>
        {% for room in allowed_rooms %}
            {% if room.public == False and room.archived == False %}
                <li class="room-link offline {{ room|seen_by:user }}"
                    data-room-type="private"
                    data-room-id="{{ room.id }}">{{ room|name_for:user }}</li>
            {% endif %}
        {% endfor %}
    </ul>

    {% comment %} ARCHIVED PUBLIC ROOMS {% endcomment %}

    <div class="container">
        <div class="row">
            <div class="col text-center">
                <p>
                    <button class="btn btn-secondary btn-sm" data-toggle="collapse" data-target="#archive" role="button" aria-expanded="false" aria-controls="collapseExample">
                    {% trans "Archived chats" %}</button>
                </p>
            </div>
        </div>
    </div>

    <div id="archive" class="collapse">
        <p>
            <ul class="list-group">
                <li class="list-group-item">
                    {% trans 'Public chat rooms are archived if they are not used for' %}
                    <span class="badge badge-primary badge-pill">{{ ARCHIVE_CHAT_ROOM }}</span>
                    {% trans 'days. After' %} 
                    <span class="badge badge-primary badge-pill">{{ DELETE_CHAT_ROOM }}</span>
                    {% trans 'days they are deleted.' %}
                </li>
                <li class="list-group-item">
                    {% trans 'Private messages are archived when user is blocked and deleted after' %} 
                    <span class="badge badge-primary badge-pill">{{ DELETE_CHAT_ROOM }}</span>
                    {% trans 'days' %}
                </li>
            </ul>
        </p>

        {% comment %} PUBLIC ROOMS {% endcomment %}
        <ul class="rooms col-md-8">
            {% for room in allowed_rooms %}
                {% if room.archived == True and room.public == True %}
                    <li class="room-link text-uppercase" data-room-id="{{ room.id }}">{{ room }}</li>
                {% endif %}
            {% endfor %}
        </ul>

        {% comment %} PRIVATE MESSAGES {% endcomment %}
        <ul class="rooms col-md-8">
            {% for room in allowed_rooms %}
                {% if room.archived == True and room.public == False %}
                    <li class="room-link" data-room-id="{{ room.id }}">{{ room }}</li>
                {% endif %}
            {% endfor %}
        </ul>
    </div>



    {% comment %} HERE CHATS WILL APPEAR {% endcomment %}
    <div id="chats" class="col-md-12"></div>

    <!-- Bootstrap modal for message history -->
    <div id="message-history-modal" class="modal fade" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
              <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">Message history</h5>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
              </div>
        </div>
   </div>
    <!-- End Modal -->



{% endblock content %}

{% block extra_body %}
    <script type="module" src="{% static 'home/js/chat/utility.js'%}"></script>
    <script type="module" src="{% static 'home/js/chat/domapi.js' %}"></script>
    <script type="module" src="{% static 'home/js/chat/wsapi.js' %}"></script>
    <script type="module" src="{% static 'home/js/chat/chat.js' %}"></script>
{% endblock extra_body %}
